#!/usr/bin/env python3
"""
Script to extract Hispanic surnames from the U.S. Census data.
"""

import csv
import requests
from io import StringIO

# U.S. Census data from the web
census_data = """Last name / Surname,Number of occurrences among people self-identifying as 'Hispanic',Surname rank among hispanics,% of people with surname self-identifying as 'hispanic',U.S. Rank,U.S. total occurrences
GARCIA,779412,1,90.8%,8,858289
RODRIGUEZ,745530,2,92.7%,9,804240
MARTINEZ,710896,3,91.7%,11,775072
HERNANDEZ,662648,4,93.8%,15,706372
LOPEZ,568768,5,91.5%,21,621536
GONZALEZ,561795,6,94.0%,23,597718
PEREZ,447729,7,91.6%,29,488521
SANCHEZ,404972,8,91.8%,33,441242
RAMIREZ,364364,9,93.7%,42,388987
TORRES,296424,10,91.2%,50,325169
FLORES,283979,11,90.8%,55,312615
RIVERA,270026,12,90.2%,59,299463
GOMEZ,240289,13,91.2%,68,263590
DIAZ,229666,14,91.2%,73,251772
REYES,202052,15,86.9%,81,232511
MORALES,199969,16,91.9%,90,217642
CRUZ,199270,17,86.2%,82,231065
ORTIZ,198260,18,92.4%,94,214683
GUTIERREZ,196703,19,92.4%,96,212905
CHAVEZ,170959,20,92.0%,118,185865
RAMOS,164943,21,85.4%,112,193096
GONZALES,163758,22,84.4%,110,193934
RUIZ,160868,23,91.7%,129,175429
ALVAREZ,153049,24,90.7%,132,168817
MENDOZA,149300,25,88.6%,134,168567
VASQUEZ,147926,26,92.5%,143,159989
CASTILLO,147023,27,88.9%,135,165473
JIMENEZ,146420,28,93.0%,147,157475
MORENO,132896,29,91.0%,170,146088
ROMERO,132444,30,86.1%,154,153772
HERRERA,129425,31,91.9%,175,140786
MEDINA,125557,32,90.1%,176,139353
AGUILAR,116527,33,92.2%,213,126399
GARZA,114783,34,92.5%,220,124130
CASTRO,113959,35,85.5%,194,133254
VARGAS,113763,36,91.8%,221,123952
FERNANDEZ,112417,37,80.7%,178,139302
GUZMAN,109736,38,92.7%,230,118390
MUNOZ,109071,39,92.6%,232,117774
MENDEZ,104394,40,92.6%,242,112736
SALAZAR,103131,41,90.9%,240,113468
SOTO,98388,42,92.3%,257,106631
DELGADO,90051,43,91.3%,282,98675
PENA,90035,44,91.6%,284,98345
RIOS,89828,45,93.0%,285,96569
ALVARADO,87697,46,93.6%,294,93723
SANDOVAL,87308,47,90.7%,287,96303
CONTRERAS,86869,48,93.8%,299,92660
VALDEZ,86599,49,87.8%,283,98610
GUERRERO,85980,50,91.3%,291,94152
ORTEGA,85522,51,91.8%,296,93131
ESTRADA,85080,52,91.7%,298,92831
NUNEZ,82279,53,91.2%,306,90208
MALDONADO,81811,54,93.0%,316,88016
VEGA,80306,55,91.5%,318,87728
VAZQUEZ,80272,56,94.5%,328,84926
SANTIAGO,79341,57,87.2%,302,90967
DOMINGUEZ,76555,58,91.4%,334,83731
ESPINOZA,74793,59,94.3%,360,79322
SILVA,73364,60,58.1%,214,126164
PADILLA,72798,61,89.0%,345,81805
MARQUEZ,71828,62,89.8%,357,79951
CORTEZ,68611,63,88.5%,367,77492
ROJAS,68183,64,93.3%,393,73071
ACOSTA,67292,65,88.0%,377,76477
FIGUEROA,66629,66,91.9%,398,72533
LUNA,65911,67,86.6%,378,76127
JUAREZ,65153,68,94.7%,429,68785
NAVARRO,64036,69,86.6%,388,73970
CAMPOS,62640,70,89.5%,420,69950
MOLINA,62579,71,89.1%,417,70211
AVILA,62461,72,89.4%,421,69843
AYALA,62198,73,93.5%,449,66515
MEJIA,62043,74,93.3%,448,66534
CARRILLO,61757,75,92.1%,443,67054
DURAN,57955,76,85.2%,434,68046
SANTOS,57733,77,58.3%,279,98993
SALINAS,56963,78,92.5%,490,61582
ROBLES,55814,79,90.6%,489,61619
SOLIS,54941,80,91.5%,497,60045
LARA,54534,81,91.3%,501,59731
CERVANTES,54507,82,94.5%,520,57685
AGUIRRE,53922,83,91.5%,508,58918
DELEON,53751,84,81.9%,460,65598
OCHOA,53303,85,93.2%,523,57210
MIRANDA,52899,86,78.2%,437,67646
CARDENAS,52632,87,93.0%,529,56618
TRUJILLO,52498,88,88.1%,504,59609
VELASQUEZ,52167,89,91.3%,525,57163
FUENTES,51655,90,91.5%,530,56441
CABRERA,51288,91,89.7%,524,57171
LEON,50651,92,81.7%,483,62034
RIVAS,50456,93,92.4%,553,54588
MONTOYA,50100,94,87.8%,526,57075
CALDERON,49824,95,91.1%,550,54691
COLON,49422,96,89.0%,539,55512
SERRANO,49160,97,89.3%,545,55057
GALLEGOS,49150,98,89.9%,551,54672
ROSALES,47347,99,92.2%,595,51336
CASTANEDA,47314,100,92.6%,600,51089"""

def main():
    # Parse the census data
    surnames = []
    lines = census_data.strip().split('\n')
    headers = lines[0].split(',')
    
    for line in lines[1:]:
        values = line.split(',')
        surname = values[0]
        count = values[1]
        surnames.append((surname, count))
    
    # Save to file
    with open('organized/census_hispanic_surnames.txt', 'w', encoding='utf-8') as f:
        f.write("# Top Hispanic Surnames from U.S. Census 2000\n")
        f.write("# Source: probablyhelpful.com/data/hispanic.html\n\n")
        f.write("# Rank\tSurname\t\tOccurrences\n")
        f.write("# ----\t-------\t\t-----------\n")
        for i, (surname, count) in enumerate(surnames, 1):
            f.write(f"{i:2d}\t{surname:<15}\t{count}\n")
    
    print(f"Extracted {len(surnames)} Hispanic surnames from U.S. Census data")
    print("File saved as hispanic_names_data/organized/census_hispanic_surnames.txt")

if __name__ == "__main__":
    main()